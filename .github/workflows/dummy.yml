name: dummy
on:
  workflow_dispatch:

jobs:
  check-llvm-strip:
    runs-on: ubuntu-latest
    steps:
      - name: Install llvm
        run: sudo apt-get update && sudo apt-get install -y llvm
      - name: Check llvm-strip
        run: which llvm-strip
  show-android-linker:
    runs-on: ubuntu-latest
    steps:
      - name: Download NDK
        run: |
          wget -q https://dl.google.com/android/repository/android-ndk-r28-linux.zip -O ndk.zip
          unzip ndk.zip
      - name: Show binaries
        run: |
          ls android-ndk-r28/toolchains/llvm/prebuilt/linux-x86_64/bin
  inspect-armv7-test-binary:
    runs-on: ubuntu-24.04-arm
    steps:
      - uses: actions/checkout@v6
      - uses: ./.github/actions/checkout-repo
      - name: Install build deps
        run: sudo apt-get update && sudo apt-get install -y gcc-arm-linux-gnueabihf binutils file
      - uses: dtolnay/rust-toolchain@stable
        with:
          targets: armv7-unknown-linux-gnueabihf
      - name: Set target
        working-directory: lightningcss
        run: rustup target add armv7-unknown-linux-gnueabihf
      - name: Build armv7 test binary
        working-directory: lightningcss
        run: cargo test --no-run --target armv7-unknown-linux-gnueabihf
      - name: Inspect armv7 test binary
        working-directory: lightningcss
        run: |
          bin_path=$(find target/armv7-unknown-linux-gnueabihf/debug/deps -maxdepth 1 -type f -executable -name 'lightningcss-*' | head -n 1)
          file "$bin_path"
          ldd "$bin_path" || true
          readelf -l "$bin_path" | sed -n '1,80p'
